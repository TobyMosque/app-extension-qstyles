import QStyle from 'quasar-app-extension-qstyles/src/styles/QStyle'
import QAjaxBar from 'quasar-app-extension-qstyles/src/styles/QAjaxBar'
import QAvatar from 'quasar-app-extension-qstyles/src/styles/QAvatar'
import QBadge from 'quasar-app-extension-qstyles/src/styles/QBadge'
import QBanner from 'quasar-app-extension-qstyles/src/styles/QBanner'
import QBar from 'quasar-app-extension-qstyles/src/styles/QBar'
import QBreadcrumbs from 'quasar-app-extension-qstyles/src/styles/QBreadcrumbs'
import QBreadcrumbsEl from 'quasar-app-extension-qstyles/src/styles/QBreadcrumbsEl'
import QBtnGroup from 'quasar-app-extension-qstyles/src/styles/QBtnGroup'
import QBtnShared from 'quasar-app-extension-qstyles/src/styles/QBtnShared'
import QBtnToggle from 'quasar-app-extension-qstyles/src/styles/QBtnToggle'
import QBtn from 'quasar-app-extension-qstyles/src/styles/QBtn'
import QBtnDropdown from 'quasar-app-extension-qstyles/src/styles/QBtnDropdown'
import QCard from 'quasar-app-extension-qstyles/src/styles/QCard'
import QCardActions from 'quasar-app-extension-qstyles/src/styles/QCardActions'
import QCardSection from 'quasar-app-extension-qstyles/src/styles/QCardSection' 
import QCarousel from 'quasar-app-extension-qstyles/src/styles/QCarousel'
import QCarouselControl from 'quasar-app-extension-qstyles/src/styles/QCarouselControl'
import QCarouselSlide from 'quasar-app-extension-qstyles/src/styles/QCarouselSlide'
import QChatMessage from 'quasar-app-extension-qstyles/src/styles/QChatMessage'
import QCheckbox from 'quasar-app-extension-qstyles/src/styles/QCheckbox'
import QChip from 'quasar-app-extension-qstyles/src/styles/QChip'
import QCircularProgress from 'quasar-app-extension-qstyles/src/styles/QCircularProgress'
import QColor from 'quasar-app-extension-qstyles/src/styles/QColor'
import QDate from 'quasar-app-extension-qstyles/src/styles/QDate'
import QPopup from 'quasar-app-extension-qstyles/src/styles/QPopup'
import QDialog from 'quasar-app-extension-qstyles/src/styles/QDialog'
import QEditor from 'quasar-app-extension-qstyles/src/styles/QEditor'
import QExpansionItem from 'quasar-app-extension-qstyles/src/styles/QExpansionItem'
import QField from 'quasar-app-extension-qstyles/src/styles/QField'
import QForm from 'quasar-app-extension-qstyles/src/styles/QForm'
import QIcon from 'quasar-app-extension-qstyles/src/styles/QIcon'
import QImg from 'quasar-app-extension-qstyles/src/styles/QImg'
import QInnerLoading from 'quasar-app-extension-qstyles/src/styles/QInnerLoading'
import QInfiniteScroll from 'quasar-app-extension-qstyles/src/styles/QInfiniteScroll'
import QInput from 'quasar-app-extension-qstyles/src/styles/QInput'
import QKnob from 'quasar-app-extension-qstyles/src/styles/QKnob'
import QLinearProgress from 'quasar-app-extension-qstyles/src/styles/QLinearProgress'
import QList from 'quasar-app-extension-qstyles/src/styles/QList'
import QItem from 'quasar-app-extension-qstyles/src/styles/QItem'
import QItemSection from 'quasar-app-extension-qstyles/src/styles/QItemSection'
import QItemLabel from 'quasar-app-extension-qstyles/src/styles/QItemLabel'
import QMarkupTable from 'quasar-app-extension-qstyles/src/styles/QMarkupTable'
import QMenu from 'quasar-app-extension-qstyles/src/styles/QMenu'
import QOptionGroup from 'quasar-app-extension-qstyles/src/styles/QOptionGroup'
import QPagination from 'quasar-app-extension-qstyles/src/styles/QPagination'
import QParallax from 'quasar-app-extension-qstyles/src/styles/QParallax'
import QPopupEdit from 'quasar-app-extension-qstyles/src/styles/QPopupEdit'
import QPopupProxy from 'quasar-app-extension-qstyles/src/styles/QPopupProxy'
import QPanels from 'quasar-app-extension-qstyles/src/styles/QPanels'
import QPanel from 'quasar-app-extension-qstyles/src/styles/QPanel'
import QRadio from 'quasar-app-extension-qstyles/src/styles/QRadio'
import QRange from 'quasar-app-extension-qstyles/src/styles/QRange'
import QSelect from 'quasar-app-extension-qstyles/src/styles/QSelect'
import QSeparator from 'quasar-app-extension-qstyles/src/styles/QSeparator'
import QSlider from 'quasar-app-extension-qstyles/src/styles/QSlider'
import QTime from 'quasar-app-extension-qstyles/src/styles/QTime'
import QToggle from 'quasar-app-extension-qstyles/src/styles/QToggle'

import QPullToRefresh from 'quasar-app-extension-qstyles/src/styles/QPullToRefresh'
import QRating from 'quasar-app-extension-qstyles/src/styles/QPullToRefresh'
import QScrollArea from 'quasar-app-extension-qstyles/src/styles/QScrollArea'
import QSlideItem from 'quasar-app-extension-qstyles/src/styles/QSlideItem'
import QSpinner from 'quasar-app-extension-qstyles/src/styles/QSpinner'
import QSplitter from 'quasar-app-extension-qstyles/src/styles/QSplitter'
import QStepper from 'quasar-app-extension-qstyles/src/styles/QStepper'
import QStepperNavigation from 'quasar-app-extension-qstyles/src/styles/QStepperNavigation'
import QStep from 'quasar-app-extension-qstyles/src/styles/QStep'
import QTable from 'quasar-app-extension-qstyles/src/styles/QTable'
import QTh from 'quasar-app-extension-qstyles/src/styles/QTh'
import QTr from 'quasar-app-extension-qstyles/src/styles/QTr'
import QTd from 'quasar-app-extension-qstyles/src/styles/QTd'
import QTabs from 'quasar-app-extension-qstyles/src/styles/QTabs'
import QTab from 'quasar-app-extension-qstyles/src/styles/QTab'
import QTabPanels from 'quasar-app-extension-qstyles/src/styles/QTabPanels'
import QTabPanel from 'quasar-app-extension-qstyles/src/styles/QTabPanel'
import QTimeline from 'quasar-app-extension-qstyles/src/styles/QTimeline'
import QTimelineEntry from 'quasar-app-extension-qstyles/src/styles/QTimelineEntry'
import QToolbar from 'quasar-app-extension-qstyles/src/styles/QToolbar'
import QToolbarTitle from 'quasar-app-extension-qstyles/src/styles/QToolbarTitle'
import QTooltip from 'quasar-app-extension-qstyles/src/styles/QTooltip'
import QTree from 'quasar-app-extension-qstyles/src/styles/QTree'
import QUploader from 'quasar-app-extension-qstyles/src/styles/QUploader'
import QVideo from 'quasar-app-extension-qstyles/src/styles/QVideo'

import QLayout from 'quasar-app-extension-qstyles/src/styles/QLayout'
import QPageContainer from 'quasar-app-extension-qstyles/src/styles/QPageContainer'
import QPageSticky from 'quasar-app-extension-qstyles/src/styles/QPageSticky'
import QPageScroller from 'quasar-app-extension-qstyles/src/styles/QPageScroller'
import QPage from 'quasar-app-extension-qstyles/src/styles/QPage'
import QHeader from 'quasar-app-extension-qstyles/src/styles/QHeader'
import QFooter from 'quasar-app-extension-qstyles/src/styles/QFooter'
import QDrawer from 'quasar-app-extension-qstyles/src/styles/QDrawer'
import QFab from 'quasar-app-extension-qstyles/src/styles/QFab'
import QFabAction from 'quasar-app-extension-qstyles/src/styles/QFabAction'

const themes = {}
const states = [
  QStyle,
  QLayout,
  QPageContainer,
  QPageSticky,
  QPageScroller,
  QPage,
  QHeader,
  QFooter,
  QDrawer,
  QFab,
  QFabAction,
  QAjaxBar,
  QAvatar,
  QBadge,
  QBanner,
  QBar,
  QBreadcrumbs,
  QBreadcrumbsEl,
  QBtnGroup,
  QBtnShared,
  QBtnToggle,
  QBtn,
  QBtnDropdown,
  QCard,
  QCardActions,
  QCardSection,
  QCarousel,
  QCarouselControl,
  QCarouselSlide,
  QChatMessage,
  QCheckbox,
  QChip,
  QCircularProgress,
  QColor,
  QDate,
  QPopup,
  QDialog,
  QEditor,
  QExpansionItem,
  QField,
  QForm,
  QIcon,
  QImg,
  QInfiniteScroll,
  QInnerLoading,
  QInput,
  QKnob,
  QLinearProgress,
  QList,
  QItem,
  QItemSection,
  QItemLabel,
  QMarkupTable,
  QMenu,
  QOptionGroup,
  QPagination,
  QParallax,
  QPopupEdit,
  QPopupProxy,
  QPanels,
  QPanel,
  QRadio,
  QRange,
  QSelect,
  QSeparator,
  QSlider,
  QTime,
  QToggle,
  QPullToRefresh,
  QRating,
  QScrollArea,
  QSlideItem,
  QSpinner,
  QSplitter,
  QStepper,
  QStepperNavigation,
  QStep,
  QTable,
  QTh,
  QTr,
  QTd,
  QTabs,
  QTab,
  QTabPanels,
  QTabPanel,
  QTimeline,
  QTimelineEntry,
  QToolbar,
  QToolbarTitle,
  QTooltip,
  QTree,
  QUploader,
  QVideo
]

class Themer {
  resolve = void 0
  ready = void 0
  themes = {}
  styles = []
  isServer = false
  constructor () {
    this.ready = new Promise(resolve => {
      this.resolve = resolve
    })
  }
  initialize (ssrContext) {
    this.isServer = !!ssrContext
    this.resolve()
  }
  reset () {
    for (let index in states) {
      let state = states[index]
      for (let key in state) {
        state[key] = void 0
      }
    }
    if (!this.isServer) {
      for (let index in this.styles) {
        document.head.removeChild(styles[index])
      }
    }
    this.styles.length = 0
  }
  setTheme  (name) {
    reset()
    if (this.themes[name]) {
      this.themes[name]()
    }
  }
  importStyle (cbImport) {
    if (!this.isServer) {
      let tag = process.env.DEV ? 'style' : 'link'
      let stylesBefore = Array.from(document.head.querySelectorAll(tag))
      cbImport().then(() => {
        let stylesAfter = Array.from(document.head.querySelectorAll(tag))
        for (let index in stylesAfter) {
          let style = stylesAfter[index]
          if (stylesBefore.indexOf(style) === -1 && styles.indexOf(style) === -1) {
            this.styles.push(style)
          }
        }
      })
    }
  }
  setTheme (name) {
    this.reset()
    if (this.themes[name]) {
      this.themes[name]()
    }
  }
  registerTheme (name, callback) {
    this.themes[name] = callback
  }
}

export default new Themer()
export {
  QStyle,
  QLayout,
  QPageContainer,
  QPageSticky,
  QPageScroller,
  QPage,
  QHeader,
  QFooter,
  QDrawer,
  QFab,
  QFabAction,
  QAjaxBar,
  QAvatar,
  QBadge,
  QBanner,
  QBar,
  QBreadcrumbs,
  QBreadcrumbsEl,
  QBtnGroup,
  QBtnShared,
  QBtnToggle,
  QBtn,
  QBtnDropdown,
  QCard,
  QCardActions,
  QCardSection,
  QCarousel,
  QCarouselControl,
  QCarouselSlide,
  QChatMessage,
  QCheckbox,
  QChip,
  QCircularProgress,
  QColor,
  QDate,
  QPopup,
  QDialog,
  QEditor,
  QExpansionItem,
  QField,
  QForm,
  QIcon,
  QImg,
  QInfiniteScroll,
  QInnerLoading,
  QInput,
  QKnob,
  QLinearProgress,
  QList,
  QItem,
  QItemSection,
  QItemLabel,
  QMarkupTable,
  QMenu,
  QOptionGroup,
  QPagination,
  QParallax,
  QPopupEdit,
  QPopupProxy,
  QPanels,
  QPanel,
  QRadio,
  QRange,
  QSelect,
  QSeparator,
  QSlider,
  QTime,
  QToggle,
  QPullToRefresh,
  QRating,
  QScrollArea,
  QSlideItem,
  QSpinner,
  QSplitter,
  QStepper,
  QStepperNavigation,
  QStep,
  QTable,
  QTh,
  QTr,
  QTd,
  QTabs,
  QTab,
  QTabPanels,
  QTabPanel,
  QTimeline,
  QTimelineEntry,
  QToolbar,
  QToolbarTitle,
  QTooltip,
  QTree,
  QUploader,
  QVideo
}
